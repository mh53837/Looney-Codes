import{r as t,U as $,ad as M,S as e,M as E,R as H,ah as I}from"./index-f65cf5b0.js";/* empty css                              */const Z=({korisnickoIme:u,onUpdateSuccess:T})=>{const[r,b]=t.useState(null),{user:U}=t.useContext($),{theme:D}=t.useContext(M),[P,h]=t.useState(!1),[S,p]=t.useState(!1),[f,x]=t.useState(""),[j,g]=t.useState(""),[v,C]=t.useState(""),[o,l]=t.useState(""),[k,i]=t.useState(""),[m,y]=t.useState(""),[N,c]=t.useState(""),L=a=>{y(a.target.value)},w=()=>{if(c(""),o===""&&k==="")return l(""),i(""),!0;if(o!==k)return l(""),i(""),c("Lozinke se ne podudaraju!"),!1;const a=8,n=/[A-Z]/.test(o),s=/[a-z]/.test(o),z=/\d/.test(o),d=/[!@#$%^&*(),.?":{}|<>]/.test(o);return o.length<a?(l(""),i(""),c("Lozinka mora sadr탑avati barem 8 znakova!"),!1):!n||!s||!z||!d?(l(""),i(""),c("Lozinka mora sadr탑avati barem jedno veliko slovo, interpunkcijski znak i broj!"),!1):!0};t.useEffect(()=>{(async()=>{try{const s=await(await fetch(`/api/user/profile/${u}`)).json();b(s),x(s.ime),g(s.prezime),C(s.email),y(s.uloga)}catch(n){console.error("Error fetching initial data:",n)}})()},[u]);const R=()=>{h(!0)},F=async()=>{p(!0);try{w()?(c(""),await O(u),h(!1),p(!1),T()):p(!1)}catch(a){console.error("Error handling edit:",a),p(!1)}},B=()=>{h(!1),c(""),x((r==null?void 0:r.ime)||""),g((r==null?void 0:r.prezime)||""),C((r==null?void 0:r.email)||""),l(""),i(""),y("")},O=async a=>{try{const n=btoa(`${U.korisnickoIme}:${U.lozinka}`),s={...f!==""&&{ime:f},...j!==""&&{prezime:j},...v!==""&&{email:v},...m!==""&&{requestedUloga:m},...o!==""&&{lozinka:o}},z={method:"POST",headers:{Authorization:`Basic ${n}`,"Content-Type":"application/json"},body:JSON.stringify(s)},d=await fetch(`/api/user/update/${a}`,z);if(d.ok){console.log(`successfully updated korisnik data for: ${a}`);const J=await d.json();console.log("API Response:",J)}else console.error("failed to update korisnik data:",d.statusText)}catch(n){console.error("error updating korisnik data:",n)}},A=()=>e.jsx(H.Suspense,{fallback:e.jsx("div",{children:"u훾itavanje..."}),children:e.jsx(I,{title:"uredi korisni훾ke podatke",open:P,onOk:F,confirmLoading:S,onCancel:B,cancelText:"odustani",okText:"spremi promjene",children:e.jsxs("div",{className:"updateFormContainer",children:[e.jsx("p",{children:"ime:"}),e.jsx("input",{className:"problemUpdateForm",type:"text",placeholder:"ime",value:f,onChange:a=>x(a.target.value)}),e.jsx("p",{children:"prezime:"}),e.jsx("input",{className:"problemUpdateForm",type:"text",placeholder:"prezime",value:j,onChange:a=>g(a.target.value)}),e.jsx("p",{children:"email:"}),e.jsx("input",{className:"problemUpdateForm",type:"text",placeholder:"email",value:v,onChange:a=>C(a.target.value)}),e.jsx("p",{children:"nova lozinka:"}),e.jsx("input",{className:"problemUpdateForm",type:"password",placeholder:"nova lozinka",value:o,onChange:a=>l(a.target.value)}),e.jsx("p",{children:"potvrdi novu lozinku:"}),e.jsx("input",{className:"problemUpdateForm",type:"password",placeholder:"nova lozinka",value:k,onChange:a=>i(a.target.value)}),e.jsxs("div",{className:"FormRow",children:[e.jsx("p",{children:"uloga: "}),e.jsxs("div",{className:"RoleOptions",children:[e.jsxs("label",{className:"RadioLbl",children:[e.jsx("input",{type:"radio",value:"VODITELJ",checked:m==="VODITELJ",onChange:L}),"voditelj"]}),e.jsxs("label",{className:"RadioLbl",children:[e.jsx("input",{type:"radio",value:"NATJECATELJ",checked:m==="NATJECATELJ",onChange:L}),"natjecatelj"]})]})]}),e.jsx("div",{className:"error",children:N})]})})});return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:R,children:"uredi profil"}),D.isThemeDark===!1?e.jsx(E,{theme:{components:{Modal:{contentBg:"#fff"},Button:{colorPrimary:"#dd7230",colorPrimaryHover:"#dd723081",colorPrimaryActive:"#dd723081"}}},children:A()}):e.jsx(E,{theme:{components:{Modal:{contentBg:"#2A2D34",headerBg:"#2A2D34",footerBg:"#2A2D34",titleColor:"#ECDCC9",colorPrimary:"#2A2D34",colorPrimaryText:"#2A2D34",colorText:"#ECDCC9"},Button:{colorPrimary:"#dd7230e0",colorPrimaryHover:"#ECDCC9",colorPrimaryActive:"#2A2D34",colorLinkHover:"#000",textHoverBg:"#2A2D34",colorText:"#2A2D34",colorPrimaryText:"#2A2D34"}}},children:A()})]})};export{Z as default};
