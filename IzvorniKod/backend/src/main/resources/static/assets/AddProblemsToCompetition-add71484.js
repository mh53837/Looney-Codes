import{r as i,U as E,a5 as S,z as e,x as z,R as D,a8 as O}from"./index-d62fd9a5.js";/* empty css                              */const w=({natjecanjeId:l,visible:h,onClose:u})=>{const[a,f]=i.useState([]),[c,m]=i.useState([]),{user:r}=i.useContext(E),{theme:C}=i.useContext(S),[j,x]=i.useState(!1),[y,k]=i.useState(!1);i.useEffect(()=>{const n={method:"GET",headers:{Authorization:`Basic ${btoa(`${r.korisnickoIme}:${r.lozinka}`)}`,"Content-Type":"application/json"}};fetch(`/api/natjecanja/get/zadaci/${l}`,n).then(o=>o.json()).then(o=>{f(o),console.log("test data: ",o)}).catch(o=>console.error("Error fetching problems:",o))},[l,r]),i.useEffect(()=>{const n={method:"GET",headers:{Authorization:`Basic ${btoa(`${r.korisnickoIme}:${r.lozinka}`)}`,"Content-Type":"application/json"}};fetch("/api/problems/my",n).then(o=>o.json()).then(o=>{const d=o.filter(s=>!a.some(B=>B.zadatakId===s.zadatakId));m(d),console.log("test data: ",o)}).catch(o=>console.error("Error fetching problems:",o))},[r,a]);const p=async t=>{try{const n=btoa(`${r.korisnickoIme}:${r.lozinka}`),o=await fetch(`/api/natjecanja/add/zadatak/${l}/${t}`,{method:"POST",headers:{Authorization:`Basic ${n}`,"Content-Type":"application/json"}});if(o.ok){const d=c.find(s=>s.zadatakId===t);d&&!a.some(s=>s.zadatakId===t)?(f([...a,d]),m(c.filter(s=>s.zadatakId!==t)),console.log("Successfully added problem to competition")):console.log("Problem is already in competitionProblems or not found in problemsToAdd")}else console.error("Failed to add problem to competition:",o.statusText)}catch(n){console.error("Error adding problem to competition:",n)}},T=async t=>{try{const n=btoa(`${r.korisnickoIme}:${r.lozinka}`),o=await fetch(`/api/natjecanja/remove/zadatak/${l}/${t}`,{method:"POST",headers:{Authorization:`Basic ${n}`,"Content-Type":"application/json"}});if(o.ok){f(a.filter(s=>s.zadatakId!==t));const d=a.find(s=>s.zadatakId===t);d&&m([...c,d]),console.log("Successfully removed problem from competition")}else console.error("Failed to remove problem from competition:",o.statusText)}catch(n){console.error("Error removing problem from competition:",n)}},v=()=>e.jsx(D.Suspense,{fallback:e.jsx("div",{children:"učitavanje..."}),children:e.jsx(O,{width:900,title:"zadaci na natjecanju",open:j,onCancel:A,okText:"spremi promjene",confirmLoading:y,footer:e.jsx("div",{children:e.jsx("button",{onClick:$,children:"spremi promjene"},"ok")}),children:e.jsxs("div",{className:"info-table",children:[(a==null?void 0:a.length)==0?e.jsx("div",{children:e.jsx("p",{children:"ovo natjecanje nema dodijeljenih zadataka"})}):e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"naziv"}),e.jsx("th",{children:"vremensko ograničenje"}),e.jsx("th",{children:"težina"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:a==null?void 0:a.map((t,n)=>e.jsxs("tr",{className:"info-table",children:[e.jsx("td",{children:t!=null&&t.nazivZadatka?t.nazivZadatka:""}),e.jsx("td",{children:t!=null&&t.vremenskoOgranicenje?t.vremenskoOgranicenje:""}),e.jsx("td",{children:(t==null?void 0:t.brojBodova)==10?"★":t.brojBodova==20?"★★":"★★★"}),e.jsx("td",{children:e.jsx("button",{style:{fontSize:18,margin:2},onClick:()=>T(t.zadatakId),children:"-"})})]},n))})]}),e.jsx("h4",{children:"odaberi zadatake:"}),c.length==0?e.jsx("p",{children:"svi zadaci su već dio natjecanja"}):e.jsx("div",{className:"info-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"naziv"}),e.jsx("th",{children:"vremensko ograničenje"}),e.jsx("th",{children:"težina"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:c==null?void 0:c.map((t,n)=>e.jsxs("tr",{className:"info-table",children:[e.jsx("td",{children:t!=null&&t.nazivZadatka?t.nazivZadatka:""}),e.jsx("td",{children:t!=null&&t.vremenskoOgranicenje?t.vremenskoOgranicenje:""}),e.jsx("td",{children:(t==null?void 0:t.brojBodova)==10?"★":t.brojBodova==20?"★★":"★★★"}),e.jsx("td",{children:e.jsx("button",{style:{fontSize:16},onClick:()=>p(t.zadatakId),children:"+"})})]},n))})]})})]})})}),$=async()=>{k(!0);try{x(!1),k(!1),u()}catch(t){console.error("Error handling edit:",t),k(!1)}},A=()=>{P(),u()},P=()=>{console.log("Clicked cancel button"),x(!1),h=!1},g=()=>{j||x(!0)};return i.useEffect(()=>{j||x(!0)},[h,j]),e.jsxs(e.Fragment,{children:[h&&g(),!h&&e.jsx("button",{onClick:g,children:"zadaci"}),C.isThemeDark==!1?e.jsx(z,{theme:{components:{Modal:{contentBg:"#fff"},Button:{colorPrimary:"#dd7230",colorPrimaryHover:"#dd723081",colorPrimaryActive:"#dd723081"}}},children:v()}):e.jsx(z,{theme:{components:{Modal:{contentBg:"#2A2D34",headerBg:"#2A2D34",footerBg:"#2A2D34",titleColor:"#ECDCC9",colorPrimary:"#ECDCC9",colorText:"#ECDCC9"},Button:{colorPrimary:"#dd7230",colorPrimaryHover:"#dd723081",colorPrimaryActive:"#dd723081",textHoverBg:"#2A2D34"}}},children:v()})]})};export{w as A};
