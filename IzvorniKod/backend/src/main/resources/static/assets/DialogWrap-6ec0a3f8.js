import{r as n,R as d,_ as M}from"./index-b0686eb3.js";import{J as de,e as x,t as u,c as q,P as te,a$ as fe,b0 as G,K as Q,b1 as me}from"./index-1172dc73.js";import{p as ve}from"./index-746205fb.js";var ae=n.createContext({});function Z(e,a,t){var o=a;return!o&&t&&(o="".concat(e,"-").concat(t)),o}function p(e,a){var t=e["page".concat(a?"Y":"X","Offset")],o="scroll".concat(a?"Top":"Left");if(typeof t!="number"){var l=e.document;t=l.documentElement[o],typeof t!="number"&&(t=l.body[o])}return t}function Ce(e){var a=e.getBoundingClientRect(),t={left:a.left,top:a.top},o=e.ownerDocument,l=o.defaultView||o.parentWindow;return t.left+=p(l),t.top+=p(l,!0),t}const ye=n.memo(function(e){var a=e.children;return a},function(e,a){var t=a.shouldUpdate;return!t});var ee={width:0,height:0,overflow:"hidden",outline:"none"},be=d.forwardRef(function(e,a){var t=e.prefixCls,o=e.className,l=e.style,i=e.title,m=e.ariaId,f=e.footer,v=e.closable,g=e.closeIcon,y=e.onClose,h=e.children,b=e.bodyStyle,N=e.bodyProps,k=e.modalRender,w=e.onMouseDown,A=e.onMouseUp,U=e.holderRef,P=e.visible,O=e.forceRender,C=e.width,I=e.height,s=e.classNames,c=e.styles,z=d.useContext(ae),B=z.panel,j=de(U,B),$=n.useRef(),V=n.useRef();d.useImperativeHandle(a,function(){return{focus:function(){var S;(S=$.current)===null||S===void 0||S.focus()},changeActive:function(S){var W=document,K=W.activeElement;S&&K===V.current?$.current.focus():!S&&K===$.current&&V.current.focus()}}});var R={};C!==void 0&&(R.width=C),I!==void 0&&(R.height=I);var E;f&&(E=d.createElement("div",{className:x("".concat(t,"-footer"),s==null?void 0:s.footer),style:u({},c==null?void 0:c.footer)},f));var _;i&&(_=d.createElement("div",{className:x("".concat(t,"-header"),s==null?void 0:s.header),style:u({},c==null?void 0:c.header)},d.createElement("div",{className:"".concat(t,"-title"),id:m},i)));var D;v&&(D=d.createElement("button",{type:"button",onClick:y,"aria-label":"Close",className:"".concat(t,"-close")},g||d.createElement("span",{className:"".concat(t,"-close-x")})));var T=d.createElement("div",{className:x("".concat(t,"-content"),s==null?void 0:s.content),style:c==null?void 0:c.content},D,_,d.createElement("div",M({className:x("".concat(t,"-body"),s==null?void 0:s.body),style:u(u({},b),c==null?void 0:c.body)},N),h),E);return d.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":i?m:null,"aria-modal":"true",ref:j,style:u(u({},l),R),className:x(t,o),onMouseDown:w,onMouseUp:A},d.createElement("div",{tabIndex:0,ref:$,style:ee,"aria-hidden":"true"}),d.createElement(ye,{shouldUpdate:P||O},k?k(T):T),d.createElement("div",{tabIndex:0,ref:V,style:ee,"aria-hidden":"true"}))}),ne=n.forwardRef(function(e,a){var t=e.prefixCls,o=e.title,l=e.style,i=e.className,m=e.visible,f=e.forceRender,v=e.destroyOnClose,g=e.motionName,y=e.ariaId,h=e.onVisibleChanged,b=e.mousePosition,N=n.useRef(),k=n.useState(),w=q(k,2),A=w[0],U=w[1],P={};A&&(P.transformOrigin=A);function O(){var C=Ce(N.current);U(b?"".concat(b.x-C.left,"px ").concat(b.y-C.top,"px"):"")}return n.createElement(te,{visible:m,onVisibleChanged:h,onAppearPrepare:O,onEnterPrepare:O,forceRender:f,motionName:g,removeOnLeave:v,ref:N},function(C,I){var s=C.className,c=C.style;return n.createElement(be,M({},e,{ref:a,title:o,ariaId:y,prefixCls:t,holderRef:I,style:u(u(u({},c),l),P),className:x(i,s)}))})});ne.displayName="Content";function Ne(e){var a=e.prefixCls,t=e.style,o=e.visible,l=e.maskProps,i=e.motionName,m=e.className;return n.createElement(te,{key:"mask",visible:o,motionName:i,leavedClassName:"".concat(a,"-mask-hidden")},function(f,v){var g=f.className,y=f.style;return n.createElement("div",M({ref:v,style:u(u({},y),t),className:x("".concat(a,"-mask"),g,m)},l))})}function Re(e){var a=e.prefixCls,t=a===void 0?"rc-dialog":a,o=e.zIndex,l=e.visible,i=l===void 0?!1:l,m=e.keyboard,f=m===void 0?!0:m,v=e.focusTriggerAfterClose,g=v===void 0?!0:v,y=e.wrapStyle,h=e.wrapClassName,b=e.wrapProps,N=e.onClose,k=e.afterOpenChange,w=e.afterClose,A=e.transitionName,U=e.animation,P=e.closable,O=P===void 0?!0:P,C=e.mask,I=C===void 0?!0:C,s=e.maskTransitionName,c=e.maskAnimation,z=e.maskClosable,B=z===void 0?!0:z,j=e.maskStyle,$=e.maskProps,V=e.rootClassName,R=e.classNames,E=e.styles,_=n.useRef(),D=n.useRef(),T=n.useRef(),H=n.useState(i),S=q(H,2),W=S[0],K=S[1],oe=fe();function le(){G(D.current,document.activeElement)||(_.current=document.activeElement)}function ie(){if(!G(D.current,document.activeElement)){var r;(r=T.current)===null||r===void 0||r.focus()}}function re(r){if(r)ie();else{if(K(!1),I&&_.current&&g){try{_.current.focus({preventScroll:!0})}catch{}_.current=null}W&&(w==null||w())}k==null||k(r)}function J(r){N==null||N(r)}var L=n.useRef(!1),X=n.useRef(),se=function(){clearTimeout(X.current),L.current=!0},ce=function(){X.current=setTimeout(function(){L.current=!1})},F=null;B&&(F=function(Y){L.current?L.current=!1:D.current===Y.target&&J(Y)});function ue(r){if(f&&r.keyCode===Q.ESC){r.stopPropagation(),J(r);return}i&&r.keyCode===Q.TAB&&T.current.changeActive(!r.shiftKey)}return n.useEffect(function(){i&&(K(!0),le())},[i]),n.useEffect(function(){return function(){clearTimeout(X.current)}},[]),n.createElement("div",M({className:x("".concat(t,"-root"),V)},ve(e,{data:!0})),n.createElement(Ne,{prefixCls:t,visible:I&&i,motionName:Z(t,s,c),style:u(u({zIndex:o},j),E==null?void 0:E.mask),maskProps:$,className:R==null?void 0:R.mask}),n.createElement("div",M({tabIndex:-1,onKeyDown:ue,className:x("".concat(t,"-wrap"),h,R==null?void 0:R.wrapper),ref:D,onClick:F,style:u(u(u({zIndex:o},y),E==null?void 0:E.wrapper),{},{display:W?null:"none"})},b),n.createElement(ne,M({},e,{onMouseDown:se,onMouseUp:ce,ref:T,closable:O,ariaId:oe,prefixCls:t,visible:i&&W,onClose:J,onVisibleChanged:re,motionName:Z(t,A,U)}))))}var ge=function(a){var t=a.visible,o=a.getContainer,l=a.forceRender,i=a.destroyOnClose,m=i===void 0?!1:i,f=a.afterClose,v=a.panelRef,g=n.useState(t),y=q(g,2),h=y[0],b=y[1],N=n.useMemo(function(){return{panel:v}},[v]);return n.useEffect(function(){t&&b(!0)},[t]),!l&&m&&!h?null:n.createElement(ae.Provider,{value:N},n.createElement(me,{open:t||l||h,autoDestroy:!1,getContainer:o,autoLock:t||h},n.createElement(Re,M({},a,{destroyOnClose:m,afterClose:function(){f==null||f(),b(!1)}}))))};ge.displayName="Dialog";export{ge as D,be as P};
